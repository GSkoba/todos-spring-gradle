!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e){function n(){}var i=n.prototype;function r(t,e,n){var i=t._eventable_registry;return e in i?i[e]:n?i[e]=[]:null}i._initEventable=function(){this._eventable_registry={}},i.on=function(t,e,n){return r(this,t,!0).push({handler:e,ctx:n}),this},i.off=function(t,e,n){var i=r(this,t);if(i)for(var o=i.length;o--;)if(i[o].handler===e&&i[o].ctx===n)return i.splice(o,1),this;return this},i.trigger=function(t,e){var n=r(this,t);if(n)for(var i=n.slice(),o=0,s=i.length;o!==s;o+=1)i[o].handler.call(i[o].ctx,e);return this},t.exports=n},function(t,e){t.exports=function(t,e){var n=t.prototype,i=e.prototype;for(var r in i)n[r]=i[r];return t}},function(t,e){newTodoRequest=function(t,e,n){var i=new XMLHttpRequest,r=JSON.stringify({itemText:n.text});i.open(t,e,!0),i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.send(r)},delTodoRequest=function(t){var e=new XMLHttpRequest,n=JSON.stringify({itemText:t.text});e.open("POST","/delTodo",!0),e.setRequestHeader("Content-type","application/json; charset=utf-8"),e.send(n)},changeItemStateRequest=function(t){var e=new XMLHttpRequest,n=JSON.stringify({itemText:t.text,itemState:t.isReady});e.open("POST","/changeItemState",!0),e.setRequestHeader("Content-type","application/json; charset=utf-8"),e.send(n)},markAsReadyAllRequest=function(){var t=new XMLHttpRequest;t.open("POST","/markAllLikeDone",!0),t.send()},getAllElementFromServer=function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===this.readyState&&200===this.status&&JSON.parse(this.responseText).forEach(function(e){t.createItem(e)})},e.open("GET","/getAll",!0),e.send()}},function(t,e){var n={ru:function(t){var e=Math.abs(t);return e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&1!==Math.floor(e%100/10)?1:2},en:function(t){return 1===Math.abs(t)?0:1}},i={language:"ru",_dictionaries:{},_getDictValue:function(t){var e=this.language;return e in this._dictionaries&&t in this._dictionaries[e]?this._dictionaries[e][t]:null},provideDict:function(t,e){return this._dictionaries[t]=e,this},simple:function(t){var e=this._getDictValue(t);return null!==e?e:t},plural:function(t,e){var i=this._getDictValue(t);if(null===i)return t;var r=i[(n[this.language]||n.ru)(e)];return null!=r?r:t}};t.exports=i},function(t,e,n){var i=n(3),r=n(13),o=n(12),s=n(11),a=n(8);n(2);document.addEventListener("DOMContentLoaded",function(){i.provideDict("ru",{todosCountLabel:["task","tasks","tasks"]});var t=new r,e=new o,n=new s,c=new a;function u(){var e=n.getItemsCount();0!==e&&t.showFullInterface(),c.setItemsCount(e)}getAllElementFromServer(n),e.on("newTodo",function(t){newTodoRequest("POST","/newTodo",t),n.createItem(t)}).on("markAsReadyAll",function(){n.markAsReadyAll()}),n.on("itemAdd",u).on("itemDelete",function(){}),c.on("clearCompleted",function(){n.removeCompletedItems()}),c.on("filterSelected",function(t){n.setFilter(t)})})},function(t,e){},function(t,e,n){var i=n(0),r="__active";function o(t){this._initEventable();var e=this._filters=t.querySelectorAll(".filter");this._currentActive=null;for(var n=e.length;n--;)e[n].addEventListener("click",this),e[n].classList.contains(r)&&(this._currentActive=e[n])}n(1)(o,i);var s=o.prototype;s._setFilter=function(t){return this._currentActive!==t&&(this._currentActive.classList.remove(r),t.classList.add(r),this._currentActive=t,this.trigger("filterSelected",t.getAttribute("data-filter"))),this},s.handleEvent=function(t){switch(t.type){case"click":this._setFilter(t.target)}},t.exports=o},function(t,e){t.exports=function(t){for(var e=t.childNodes,n=0,i=e.length;n!==i;n+=1)if("#text"===e[n].nodeName)return e[n];var r=document.createTextNode("");return t.appendChild(r),r}},function(t,e,n){var i=n(1),r=n(7),o=n(0),s=n(3),a=n(6);function c(){this._initEventable(),this._counterNode=document.querySelector(".js-todos-actions-bar_counter"),this._counterNodeText=r(this._counterNode),this._clearCompletedNode=document.querySelector(".js-todos-actions-bar_clear-completed"),this._clearCompletedNode.addEventListener("click",this),this._filters=new a(document.querySelector(".js-todos-actions-bar_filter")),this._filters.on("filterSelected",this._onFilterSelected,this)}i(c,o);var u=c.prototype;u._onFilterSelected=function(t){this.trigger("filterSelected",t)},u._clearCompleted=function(){return this.trigger("clearCompleted"),this},u.setItemsCount=function(t){return this._counterNodeText.nodeValue=t+" "+s.plural("todosCountLabel",t),this},u.handleEvent=function(t){switch(t.type){case"click":this._clearCompleted()}},t.exports=c},function(t,e){var n=document.createElement("div");var i={todoItem:function(t){var e=function(t){var e=document.getElementById(t);n.innerHTML=e.innerHTML;var i=n.children[0];return n.removeChild(i),i}("todoItemTemplate"),i=e.querySelector(".js-todo-item_mark-ready"),r=e.querySelector(".js-todo-item_remove-action"),o=e.querySelector(".js-todo-item_text");return t.text&&(o.innerText=t.text),t.isReady&&(i.checked=!0),{root:e,text:o,markReady:i,removeAction:r}}};t.exports=i},function(t,e,n){var i=n(0),r=n(1),o=n(9);n(2);function s(t){this._initEventable();var e=o.todoItem({text:t.text});this._root=e.root,this._markReady=e.markReady,this._removeAction=e.removeAction,this._text=e.text,this.model={id:t.id,isReady:t.isReady||!1,text:t.text},t.isReady&&this.setReady(!0),this._markReady.addEventListener("change",this),this._removeAction.addEventListener("click",this),this._text.addEventListener("input",this)}r(s,i);var a=s.prototype;a.render=function(t){return t.appendChild(this._root),this},a.handleEvent=function(t){switch(t.type){case"change":this.setReady(this._markReady.checked);break;case"click":t.target===this._removeAction&&this.remove();break;case"input":this.setText(this._text.innerText)}},a.setText=function(t){return this.model.text!==t&&(this._text.innerHTML=t,this.model.text=t,this.trigger("change",this.model)),this},a._setReadyModificator=function(t){return t?this._root.classList.add("__ready"):this._root.classList.remove("__ready"),this},a.setReady=function(t){return t!==this.model.isReady&&(changeItemStateRequest(this.model),this._markReady.checked=t,this.model.isReady=t,this._setReadyModificator(t),this.trigger("change",this.model)),this},a.remove=function(){return delTodoRequest(this.model),this._root.parentNode.removeChild(this._root),this.trigger("remove",this.model.id),this},a.show=function(){return this._root.classList.remove("__hide"),this},a.hide=function(){return this._root.classList.add("__hide"),this},t.exports=s},function(t,e,n){var i=n(0),r=n(1),o=(n(2),n(10)),s=".js-todos-list",a=0;function c(){this._items=[],this._todosList=document.querySelector(s),this._currentFilter="all",this._initEventable()}r(c,i);var u=c.prototype;u.getItemsCount=function(){return this._items.length},u.createItem=function(t){var e=new o(Object.assign({id:a++},t));return this._items.push(e),e.on("change",this._onItemChange,this).on("remove",this._onItemRemove,this).render(this._todosList),this.trigger("itemAdd",e),this},u.removeCompletedItems=function(){for(var t=this._items,e=t.length;e--;)t[e].model.isReady&&t[e].remove();return this},u._getItemById=function(t){for(var e=this._items,n=e.length;n--;)if(e[n].model.id===t)return e[n];return null},u._onItemChange=function(t){this.filterShowedItems(this._currentFilter)},u._onItemRemove=function(t){var e=this._getItemById(t);if(e){e.off("change",this._onItemChange,this),e.off("remove",this._onItemRemove,this);var n=this._items.indexOf(e);this._items.splice(n,1),this.trigger("itemDelete",e.model)}return this},u.markAsReadyAll=function(){return markAsReadyAllRequest(),this._items.forEach(function(t){t.setReady(!0)}),this},u.setFilter=function(t){return this._currentFilter=t,this.filterShowedItems(t)},u.filterShowedItems=function(t){return this._items.forEach(function(e){switch(t){case"all":e.show();break;case"ready":e.model.isReady?e.show():e.hide();break;case"unready":e.model.isReady?e.hide():e.show()}}),this},t.exports=c},function(t,e,n){var i=".js-todos-todo-input",r=".js-todos-select-all";function o(){this._todoInput=document.querySelector(i),this._todoSelectAll=document.querySelector(r),this._todoInput.addEventListener("keypress",this),this._todoSelectAll.addEventListener("click",this),this._initEventable()}n(1)(o,n(0));var s=o.prototype;s._markAsReadyAll=function(){return this.trigger("markAsReadyAll")},s._addItem=function(){var t=this._todoInput.value.trim();return 0!==t.length&&(this._todoInput.value=""),this.trigger("newTodo",{text:t})},s.handleEvent=function(t){switch(t.type){case"click":this._markAsReadyAll();break;case"keypress":13===t.keyCode&&this._addItem()}},t.exports=o},function(t,e){var n=".js-todos-main";function i(){this._todosMain=document.querySelector(n)}var r=i.prototype;r.showFullInterface=function(){return this._todosMain.classList.add("__has-todos"),this},r.hideFullInterface=function(){return this._todosMain.classList.remove("__has-todos"),this},t.exports=i},function(t,e,n){n(4),n(4),t.exports=n(5)}]);