!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=12)}([function(t,e){function i(){}var n=i.prototype;function r(t,e,i){var n=t._eventable_registry;return e in n?n[e]:i?n[e]=[]:null}n._initEventable=function(){this._eventable_registry={}},n.on=function(t,e,i){return r(this,t,!0).push({handler:e,ctx:i}),this},n.off=function(t,e,i){var n=r(this,t);if(n)for(var o=n.length;o--;)if(n[o].handler===e&&n[o].ctx===i)return n.splice(o,1),this;return this},n.trigger=function(t,e){var i=r(this,t);if(i)for(var n=i.slice(),o=0,s=n.length;o!==s;o+=1)n[o].handler.call(n[o].ctx,e);return this},t.exports=i},function(t,e){t.exports=function(t,e){var i=t.prototype,n=e.prototype;for(var r in n)i[r]=n[r];return t}},function(t,e){var i={ru:function(t){var e=Math.abs(t);return e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&1!==Math.floor(e%100/10)?1:2},en:function(t){return 1===Math.abs(t)?0:1}},n={language:"ru",_dictionaries:{},_getDictValue:function(t){var e=this.language;return e in this._dictionaries&&t in this._dictionaries[e]?this._dictionaries[e][t]:null},provideDict:function(t,e){return this._dictionaries[t]=e,this},simple:function(t){var e=this._getDictValue(t);return null!==e?e:t},plural:function(t,e){var n=this._getDictValue(t);if(null===n)return t;var r=n[(i[this.language]||i.ru)(e)];return null!=r?r:t}};t.exports=n},function(t,e){newTodoRequest=function(t,e,i){var n=new XMLHttpRequest,r=JSON.stringify({itemText:i.text});n.open(t,e,!0),n.setRequestHeader("Content-type","application/json; charset=utf-8"),n.send(r)}},function(t,e,i){var n=i(0),r="__active";function o(t){this._initEventable();var e=this._filters=t.querySelectorAll(".filter");this._currentActive=null;for(var i=e.length;i--;)e[i].addEventListener("click",this),e[i].classList.contains(r)&&(this._currentActive=e[i])}i(1)(o,n);var s=o.prototype;s._setFilter=function(t){return this._currentActive!==t&&(this._currentActive.classList.remove(r),t.classList.add(r),this._currentActive=t,this.trigger("filterSelected",t.getAttribute("data-filter"))),this},s.handleEvent=function(t){switch(t.type){case"click":this._setFilter(t.target)}},t.exports=o},function(t,e){t.exports=function(t){for(var e=t.childNodes,i=0,n=e.length;i!==n;i+=1)if("#text"===e[i].nodeName)return e[i];var r=document.createTextNode("");return t.appendChild(r),r}},function(t,e,i){var n=i(1),r=i(5),o=i(0),s=i(2),a=i(4);function c(){this._initEventable(),this._counterNode=document.querySelector(".js-todos-actions-bar_counter"),this._counterNodeText=r(this._counterNode),this._clearCompletedNode=document.querySelector(".js-todos-actions-bar_clear-completed"),this._clearCompletedNode.addEventListener("click",this),this._filters=new a(document.querySelector(".js-todos-actions-bar_filter")),this._filters.on("filterSelected",this._onFilterSelected,this)}n(c,o);var u=c.prototype;u._onFilterSelected=function(t){this.trigger("filterSelected",t)},u._clearCompleted=function(){return this.trigger("clearCompleted"),this},u.setItemsCount=function(t){return this._counterNodeText.nodeValue=t+" "+s.plural("todosCountLabel",t),this},u.handleEvent=function(t){switch(t.type){case"click":this._clearCompleted()}},t.exports=c},function(t,e){var i=document.createElement("div");var n={todoItem:function(t){var e=function(t){var e=document.getElementById(t);i.innerHTML=e.innerHTML;var n=i.children[0];return i.removeChild(n),n}("todoItemTemplate"),n=e.querySelector(".js-todo-item_mark-ready"),r=e.querySelector(".js-todo-item_remove-action"),o=e.querySelector(".js-todo-item_text");return t.text&&(o.innerText=t.text),t.isReady&&(n.checked=!0),{root:e,text:o,markReady:n,removeAction:r}}};t.exports=n},function(t,e,i){var n=i(0),r=i(1),o=i(7);function s(t){this._initEventable();var e=o.todoItem({text:t.text});this._root=e.root,this._markReady=e.markReady,this._removeAction=e.removeAction,this._text=e.text,this.model={id:t.id,isReady:t.isReady||!1,text:t.text},t.isReady&&this._setReadyModificator(!0),this._markReady.addEventListener("change",this),this._removeAction.addEventListener("click",this),this._text.addEventListener("input",this)}r(s,n);var a=s.prototype;a.render=function(t){return t.appendChild(this._root),this},a.handleEvent=function(t){switch(t.type){case"change":this.setReady(this._markReady.checked);break;case"click":t.target===this._removeAction&&this.remove();break;case"input":this.setText(this._text.innerText)}},a.setText=function(t){return this.model.text!==t&&(this._text.innerHTML=t,this.model.text=t,this.trigger("change",this.model)),this},a._setReadyModificator=function(t){return t?this._root.classList.add("__ready"):this._root.classList.remove("__ready"),this},a.setReady=function(t){return t!==this.model.isReady&&(this._markReady.checked=t,this.model.isReady=t,this._setReadyModificator(t),this.trigger("change",this.model)),this},a.remove=function(){return this._root.parentNode.removeChild(this._root),this.trigger("remove",this.model.id),this},a.show=function(){return this._root.classList.remove("__hide"),this},a.hide=function(){return this._root.classList.add("__hide"),this},t.exports=s},function(t,e,i){var n=i(0),r=i(1),o=i(8),s=".js-todos-list",a=0;function c(){this._items=[],this._todosList=document.querySelector(s),this._currentFilter="all",this._initEventable()}r(c,n);var u=c.prototype;u.getItemsCount=function(){return this._items.length},u.createItem=function(t){var e=new o(Object.assign({id:a++},t));return this._items.push(e),e.on("change",this._onItemChange,this).on("remove",this._onItemRemove,this).render(this._todosList),this.trigger("itemAdd",e),this},u.removeCompletedItems=function(){for(var t=this._items,e=t.length;e--;)t[e].model.isReady&&t[e].remove();return this},u._getItemById=function(t){for(var e=this._items,i=e.length;i--;)if(e[i].model.id===t)return e[i];return null},u._onItemChange=function(t){this.filterShowedItems(this._currentFilter)},u._onItemRemove=function(t){var e=this._getItemById(t);if(e){e.off("change",this._onItemChange,this),e.off("remove",this._onItemRemove,this);var i=this._items.indexOf(e);this._items.splice(i,1),this.trigger("itemDelete",e.model)}return this},u.markAsReadyAll=function(){return this._items.forEach(function(t){t.setReady(!0)}),this},u.setFilter=function(t){return this._currentFilter=t,this.filterShowedItems(t)},u.filterShowedItems=function(t){return this._items.forEach(function(e){switch(t){case"all":e.show();break;case"ready":e.model.isReady?e.show():e.hide();break;case"unready":e.model.isReady?e.hide():e.show()}}),this},t.exports=c},function(t,e,i){var n=".js-todos-todo-input",r=".js-todos-select-all";function o(){this._todoInput=document.querySelector(n),this._todoSelectAll=document.querySelector(r),this._todoInput.addEventListener("keypress",this),this._todoSelectAll.addEventListener("click",this),this._initEventable()}i(1)(o,i(0));var s=o.prototype;s._markAsReadyAll=function(){return this.trigger("markAsReadyAll")},s._addItem=function(){var t=this._todoInput.value.trim();return 0!==t.length&&(this._todoInput.value=""),this.trigger("newTodo",{text:t})},s.handleEvent=function(t){switch(t.type){case"click":this._markAsReadyAll();break;case"keypress":13===t.keyCode&&this._addItem()}},t.exports=o},function(t,e){var i=".js-todos-main";function n(){this._todosMain=document.querySelector(i)}var r=n.prototype;r.showFullInterface=function(){return this._todosMain.classList.add("__has-todos"),this},r.hideFullInterface=function(){return this._todosMain.classList.remove("__has-todos"),this},t.exports=n},function(t,e,i){var n=i(2),r=i(11),o=i(10),s=i(9),a=i(6);i(3);document.addEventListener("DOMContentLoaded",function(){n.provideDict("ru",{todosCountLabel:["task","tasks","tasks"]});var t=new r,e=new o,i=new s,c=new a;function u(){var e=i.getItemsCount();0!==e&&t.showFullInterface(),c.setItemsCount(e)}e.on("newTodo",function(t){newTodoRequest("POST","/test",t),i.createItem(t)}).on("markAsReadyAll",function(){i.markAsReadyAll()}),i.on("itemAdd",u).on("itemDelete",u),c.on("clearCompleted",function(){i.removeCompletedItems()}),c.on("filterSelected",function(t){i.setFilter(t)})})}]);